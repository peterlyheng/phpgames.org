import{N as R,O as L,B as T,j as U}from"./entry.7aa2e1a5.js";import{u as A,w as D,x as S,s as _,y as b,z as O,A as N,B as I,C as W,D as F}from"./constants.fdd6dcf3.js";import{S as C}from"./HLConst.414de9c2.js";function y(r){const s=r.split("/");return s.includes("v2")||s.includes("preview")}function Z(r,s){}function ee(r,s){var h,w;if(!((h=Object.keys(s??{}))!=null&&h.length))return r;const g=new URL(r);return(w=Object.keys(s))==null||w.forEach(m=>{g.searchParams.append(m,s[m])}),g==null?void 0:g.href}const ne=()=>{const r=A(),s=R(),g=L(),{$bus:h}=U();function w(){return window.location.search}function m(e){e&&(e=e.replace("tel:",""),window.location.href="tel://"+e)}function E(e){e&&(e=e.replace("sms:",""),window.location.href="sms://"+e)}function $(e){e&&(e=e.replace("mailto:",""),window.location.href="mailto:"+e)}function k(e,n){const t=`_mf_${e}`,o=JSON.stringify(n),a=T(t,{path:"/",maxAge:31536e3});a.value=o,D(t,o)}function x(e){const{extra:n}=e;r.value.videoExistsInPage&&h.$emit("handle-redirect"),n.action.value==="go-to-next-funnel-step"?f():n.action.value==="url"&&P(n.visitWebsite.value)}function f(e,n=!1,t){r.value.videoExistsInPage&&h.$emit("handle-redirect");try{const o=s.path.split("/"),a=r.value.funnelSteps||[],l=e?S({funnelSteps:a,stepId:e}):S({funnelSteps:a,funnelNextStep:r.value.funnelNextStep});let i=l==null?void 0:l.url;(o.includes("v2")||o.includes("preview"))&&(i=l?`/v2/preview/${l.id}`:""),t&&(i+=`/product/${t}`);const c=r.value.funnelDomain;if(window.location.hostname!=="localhost"&&!(o.includes("v2")||o.includes("preview"))&&c!==window.location.hostname){const u=`https://${c}${i}`+w();P({url:u,newTab:n})}else{if(n){const u=g.resolve({path:i});window.open(u.href+w(),"_blank");return}window.location.href=i+w();return}}catch(o){console.error(o)}}function P({url:e,newTab:n}){r.value.videoExistsInPage&&h.$emit("handle-redirect"),e=_(e);let t=r.value.locationId;const o=b(t);o&&(e=O(e,o)),n?window.open(e,"_blank")===null&&(window.location.href=e):window.location.href=e}const p=(e,n=!0,t)=>{try{const o=s.path.split("/"),a=r.value.funnelSteps||[],l=s.query,i=S({funnelSteps:a,stepId:e});if(i&&!i.id)return"#";if(o.includes("v2")||o.includes("preview")){let v="";return i&&(v=`/v2/preview/${i.id}`),t&&(v+=`/product/${t}`),v}let c=i==null?void 0:i.url;delete l.domain,delete l.page_url,delete l.additional_route,delete l.step_id,delete l.funnel_id,delete l.page_id;const u=r.value.funnelDomain;t&&(c+=`/product/${t}`);const d=new URL(c,`https://${u}`);return n&&Object.keys(l).forEach(v=>{d.searchParams.append(v,l[v])}),N({url:d.href})}catch{return"#"}};return{call:m,sms:E,mailTo:$,createMembershipToken:k,goToNextFunnelStep:f,openUrl:P,getNextFunnelStepURL:p,redirectOnSubmit:x,goToEcomPrdouctListPage:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-product-list");e&&f(e==null?void 0:e.value)},goToEcomCartPage:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-cart");e&&f(e==null?void 0:e.value)},redirectAction:(e,n,t,o,a,l,i)=>{try{const{saleAction:c,stepPath:u,visitWebsite:d}=e;I(n.value.funnelId,t,i),W(n.value.funnelId);const v={name:o.fullName,addressLine1:o.address,city:o.city,state:o.state,zip:o.zipcode,country:o.country};if(F(n.value.funnelId,v),!c)if(n.value.funnelNextStep){f();return}else throw new Error("Redirect not handled");switch(c.value){case"url":if(d&&d.value&&d.value.url){P(d.value);break}else throw new Error("Redirect not handled");case"step-path":if(u&&u.value){f(u.value);break}else throw new Error("Redirect not handled");case"go-to-next-funnel-step":if(n.value.funnelNextStep){f();break}else throw new Error("Redirect not handled")}}catch(c){if(console.error(c),a)alert(l);else{const u=JSON.parse(localStorage.getItem("_ud")||"{}"),d=[C.sepa].includes(localStorage.getItem(`pmt_${n.value.funnelId}_${u==null?void 0:u.id}`)||"")?"We are proccessing your order with the bank. We'll confirm you order after bank's confirmation.":`Order successfully placed! 
 However, Something went wrong while displaying this webpage, please contact the seller.`;alert(d)}}},getEcomProductListPageUrl:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-product-list");return e?y(window.location.pathname)?`${window.location.origin}/v2/preview/${e==null?void 0:e.id}`:`https://${r.value.funnelDomain}${e.url}`:""},goToStep:(e,n,t)=>{if(w()){e==null||e.preventDefault();const a=p(n,!0);t?window.open(a,"_blank")===null&&(window.location.href=a):window.location.href=a}},goToEcomCheckoutPage:()=>{var n;const e=(n=r.value.funnelSteps)==null?void 0:n.find(t=>(t==null?void 0:t.key)==="store-checkout");e&&f(e==null?void 0:e.value)},getEcomProductListPagePath:e=>{var o;const n=(o=r.value.funnelSteps)==null?void 0:o.find(a=>(a==null?void 0:a.key)==="store-product-list");if(!n)return"";let t="";return y(s.path)?t=`/v2/preview/${n==null?void 0:n.id}`:t=`https://${r.value.funnelDomain}${n.url}`,e&&(t+=`/collections/${e}`),t},goToEcomPrdouctDetailPage:e=>{var t;const n=(t=r.value.funnelSteps)==null?void 0:t.find(o=>(o==null?void 0:o.key)==="store-product-detail");n&&f(n==null?void 0:n.value,!1,e)},getRedirectActionUrl:e=>{var a;const{saleAction:n,stepPath:t,visitWebsite:o}=e;if(!n)return r.value.funnelNextStep?p():"";switch(n.value){case"url":return((a=o==null?void 0:o.value)==null?void 0:a.url)??"";case"step-path":return t!=null&&t.value?p(t.value):"";case"go-to-next-funnel-step":{const l=r.value.funnelSteps||[],i=S({funnelSteps:l,funnelNextStep:r.value.funnelNextStep});return r.value.funnelNextStep&&(i!=null&&i.value)?p(i.value):""}default:return""}},getEcomProductDetailURL:e=>{var t;const n=(t=r.value.funnelSteps)==null?void 0:t.find(o=>(o==null?void 0:o.key)==="store-product-detail");if(n)return p(n==null?void 0:n.value,!1,e)}}};export{ee as a,Z as g,y as i,ne as u};
