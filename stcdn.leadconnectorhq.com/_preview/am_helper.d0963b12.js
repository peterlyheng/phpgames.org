import{P as d,B as s}from"./entry.7aa2e1a5.js";import{$ as u}from"./constants.fdd6dcf3.js";const{addHeaderFromCookieForReferer:g}=u(),v=()=>{var i,a;const e={version:"2021-04-15"},t=(a=(i=Intl==null?void 0:Intl.DateTimeFormat())==null?void 0:i.resolvedOptions())==null?void 0:a.timeZone;return t&&(e.timezone=t),g(e),e},_=e=>{const t=d();return $fetch.create({baseURL:e||t.public.REST_API_URLS,headers:v()})},h={ValidateAffiliateCampaign:e=>_()("/affiliate-manager/affiliate-campaign/validate",{body:e,method:"POST"})},m="am_fingerprint",A="am_id",F="sam_id",w=async(e,t,i,a)=>{try{let n="";n=window.location.href;const p={locationId:e,funnelId:t,amId:i,samId:a,fingerprint:s(m).value||"",accessUrl:n},o=await h.ValidateAffiliateCampaign(p);if(o.valid&&o.fingerprint&&o.timestamp){const{fingerprint:f,timestamp:r}=o,l=s(m,{expires:new Date(r),path:"/",samesite:"none"});if(i){const c=s(A,{expires:new Date(r),path:"/",samesite:"none"});l.value=f,c.value=i}else if(a){const c=s(F,{expires:new Date(r),path:"/",samesite:"none"});l.value=f,c.value=a}}}catch(n){console.error("Failed to add affiliate cookie!",n)}};export{w as s};
